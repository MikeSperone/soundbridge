{"version":3,"sources":["../../src/js/soundbridge.js"],"names":[],"mappings":"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","file":"soundbridge.js","sourcesContent":["\"use strict\";\r\n//Global test variable\r\nlet test;\r\n$.getJSON(\"js/settings.json\",\r\n    function(json){\r\n        console.log(\"settings loaded\");\r\n        run(json);\r\n    });\r\n\r\nfunction run(settings) {\r\n\r\n    /*\r\n    * Audio setup\r\n    */\r\n\r\n    // Sensors\r\n    let sensor = $('.sensor');\r\n    let rate = 1;\r\n    let zeroOut, oneOut, twoOut, threeOut;\r\n\r\n    // load settings\r\n    let i = Math.floor(Math.random() * 29);\r\n    let samples = settings.samples[i];\r\n    let grainSettings = settings.grain[i];\r\n    let delaySettings = settings.delay[i];\r\n\r\n    console.log(\"setting number: \" + i);\r\n\r\n    // set samples\r\n    let audioZero = 'audio/' + samples[0] + '.mp3';\r\n    let audioOne = 'audio/' + samples[1] + '.mp3';\r\n    let audioTwo = 'audio/' + samples[2] + '.mp3';\r\n    let audioThree = 'audio/' + samples[3] + '.mp3';\r\n    let audioThreeHold = 'audio/hold/' + samples[3] + '_slow.mp3';\r\n\r\n    let delayOn = true;\r\n    let context = new AudioContext();\r\n\r\n    if (samples.a !== \"\") {\r\n        let audioAmb = 'audio/' + samples.a + '.mp3';\r\n        let ambient = new Play(audioAmb, context);\r\n        ambient.play();\r\n    }\r\n\r\n    let zero = new Playgroove(audioZero, context);\r\n    zero.delaySwitch(delaySettings[0]);\r\n\r\n    let one = new Playgroove(audioOne, context);\r\n    one.delaySwitch(delaySettings[1]);\r\n\r\n    let two = new Playgrain(audioTwo, context);\r\n    two.scatter = grainSettings[0];\r\n    two.fade = grainSettings[1];\r\n    two.spread = grainSettings[2];\r\n    two.feedback = grainSettings[3];\r\n\r\n    let three = new Loop(audioThree, context);\r\n    let threeHold = new Play(audioThreeHold, context);\r\n    //three.delay(delaySettings[4]);\r\n\r\n    let threePosition = 0;\r\n\r\n    let ws = new WebSocket('ws://mikesperone.com:31296');\r\n\r\n    let over = function(id){\r\n\r\n        switch (id) {\r\n            case 'zero':\r\n                clearTimeout(zeroOut);\r\n                zero.volume.gain.value = 1;\r\n                break;\r\n            case 'one':\r\n                clearTimeout(oneOut);\r\n                one.volume.gain.value = 0.7;\r\n                break;\r\n            case 'two':\r\n                clearTimeout(twoOut);\r\n                two.vol = 1;\r\n                break;\r\n            case 'three':\r\n                clearTimeout(threeOut);\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n\r\n    };\r\n\r\n    function out(id){\r\n\r\n        switch (id) {\r\n            case 'zero':\r\n                zeroOut = setTimeout(function(){ zero.vol(0); }, 5000);\r\n                break;\r\n            case 'one':\r\n                oneOut = setTimeout(function(){ one.vol(0); }, 5000);\r\n                break;\r\n            case 'two':\r\n                twoOut = setTimeout(function(){ two.vol = 0; }, 5000);\r\n                break;\r\n            case 'three':\r\n                threeOut = setTimeout(function(){ three.stop(); threeHold.stop();}, 5000);\r\n                threePosition = 0;\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n\r\n    }\r\n\r\n    ws.onopen = function(){\r\n        ws.onmessage = function(e){\r\n\r\n            let data = JSON.parse(e.data);\r\n            //console.log(data);\r\n            if (data.out) {\r\n                out(data.out);\r\n            } else if (data.over) {\r\n                over(data.over);\r\n            } else if (data.data) {\r\n                //id: e.data[0]\r\n                //value: e.data[1]\r\n                moveHand(data.data[1], data.data[0], 'remote');\r\n\r\n            }\r\n\r\n        };\r\n    };\r\n\r\n    sensor.on(\"mouseover\", function() {\r\n        over(this.id);\r\n        ws.send('{\"over\": \"'+this.id+'\"}');\r\n    });\r\n    sensor.on(\"mouseout\", function() {\r\n        out(this.id);\r\n        ws.send('{\"out\": \"'+this.id+'\"}');\r\n\r\n    });\r\n\r\n    sensor.on(\"mousemove\", function(event) {\r\n        //event.pageX range: 60 - 400\r\n\r\n        moveHand(event, this.id, 'local');\r\n        //ws.send('{\\\"data\\\": [\"'+this.id+'\", '+event.pageX+']}');\r\n\r\n    });\r\n\r\n    function moveHand(event, id, src) {\r\n\r\n        event = (src === 'local') ? event.pageX : event;\r\n        rate = (event/270);                   // range of .225 - 1.48\r\n        $('#'+id).children('.value').text(rate.toFixed(2));\r\n\r\n        switch (id) {\r\n            case 'zero':\r\n                zero.pbRate(rate);\r\n                if (delayOn) {\r\n                    zero.delTime(event/485);      // range of .125 - .825(s)\r\n                    zero.delFeedback(event/808);  // range of.075 - .495\r\n                }\r\n                break;\r\n            case 'one':\r\n                one.pbRate(rate);\r\n                if (delayOn) {\r\n                    one.delTime(event/485);\r\n                    one.delFeedback(event/808);\r\n                }\r\n                break;\r\n            case 'two':\r\n                two.read = rate;\r\n                break;\r\n            case 'three':\r\n\r\n                if (event > 231) {\r\n                    console.log('entered 3.  From ' + threePosition);\r\n                    if (threePosition !== 3) { threeHold.stop(); }\r\n                    threePosition = 3;\r\n                    three.sensor(event / 11);\r\n\r\n                } else if (event < 121) {\r\n                    console.log('entered 1.  From ' + threePosition);\r\n                    if (threePosition !== 1) {\r\n                        console.log('threePosition != 1');\r\n                        if (threePosition !== 1) { threeHold.stop(); }\r\n                        threePosition = 1;\r\n                        three.sensor(event / 11);\r\n                    }\r\n\r\n                } else {\r\n                    console.log('entered 2.  From ' + threePosition);\r\n                    if (threePosition !== 2) {\r\n                        three.stop();\r\n                        threePosition = 2;\r\n                        threeHold.vol = 1;\r\n                        threeHold.startSample(0);\r\n                    }\r\n\r\n                }\r\n\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n    }\r\n}\r\n\r\n"]}